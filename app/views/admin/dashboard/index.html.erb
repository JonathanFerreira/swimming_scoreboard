<% content_for :title, "Admin Dashboard" %>

<div class="mx-auto max-w-screen-2xl p-4 md:p-6 2xl:p-10">
  <div class="mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
    <h2 class="text-title-md2 font-bold text-black dark:text-white">
      Dashboard
    </h2>
  </div>

  <!-- Stats Cards -->
  <div class="grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-6 xl:grid-cols-4 2xl:gap-7.5">
    <div class="rounded-sm border border-stroke bg-white py-6 px-7.5 shadow-default dark:border-strokedark dark:bg-boxdark">
      <div class="flex h-11.5 w-11.5 items-center justify-center rounded-full bg-meta-2 dark:bg-meta-4">
        <svg class="fill-primary dark:fill-white" width="22" height="16" viewBox="0 0 22 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M11 15.1156C4.19376 15.1156 0.825012 8.61876 0.618762 8.28001C0.540012 8.13126 0.540012 7.86876 0.618762 7.72126C0.825012 7.38251 4.19376 0.88501 11 0.88501C17.8063 0.88501 21.175 7.38251 21.3813 7.72126C21.46 7.86876 21.46 8.13126 21.3813 8.28001C21.175 8.61876 17.8063 15.1156 11 15.1156ZM2.16251 8.00001C3.74001 10.0688 7.09001 13.8688 11 13.8688C14.91 13.8688 18.26 10.0688 19.8375 8.00001C18.26 5.93126 14.91 2.13126 11 2.13126C7.09001 2.13126 3.74001 5.93126 2.16251 8.00001Z" fill=""></path>
          <path d="M11 10.9219C9.38438 10.9219 8.07812 9.61562 8.07812 8C8.07812 6.38438 9.38438 5.07812 11 5.07812C12.6156 5.07812 13.9219 6.38438 13.9219 8C13.9219 9.61562 12.6156 10.9219 11 10.9219ZM11 6.625C10.3813 6.625 9.875 7.13125 9.875 7.75C9.875 8.36875 10.3813 8.875 11 8.875C11.6187 8.875 12.125 8.36875 12.125 7.75C12.125 7.13125 11.6187 6.625 11 6.625Z" fill=""></path>
        </svg>
      </div>

      <div class="mt-4 flex items-end justify-between">
        <div>
          <h4 class="text-title-md font-bold text-black dark:text-white">
            <%= @competitions_count %>
          </h4>
          <span class="text-sm font-medium">Total Competitions</span>
        </div>
      </div>
    </div>

    <div class="rounded-sm border border-stroke bg-white py-6 px-7.5 shadow-default dark:border-strokedark dark:bg-boxdark">
      <div class="flex h-11.5 w-11.5 items-center justify-center rounded-full bg-meta-2 dark:bg-meta-4">
        <svg class="fill-primary dark:fill-white" width="20" height="22" viewBox="0 0 20 22" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M11 15.1156C4.19376 15.1156 0.825012 8.61876 0.618762 8.28001C0.540012 8.13126 0.540012 7.86876 0.618762 7.72126C0.825012 7.38251 4.19376 0.88501 11 0.88501C17.8063 0.88501 21.175 7.38251 21.3813 7.72126C21.46 7.86876 21.46 8.13126 21.3813 8.28001C21.175 8.61876 17.8063 15.1156 11 15.1156ZM2.16251 8.00001C3.74001 10.0688 7.09001 13.8688 11 13.8688C14.91 13.8688 18.26 10.0688 19.8375 8.00001C18.26 5.93126 14.91 2.13126 11 2.13126C7.09001 2.13126 3.74001 5.93126 2.16251 8.00001Z" fill=""></path>
          <path d="M11 10.9219C9.38438 10.9219 8.07812 9.61562 8.07812 8C8.07812 6.38438 9.38438 5.07812 11 5.07812C12.6156 5.07812 13.9219 6.38438 13.9219 8C13.9219 9.61562 12.6156 10.9219 11 10.9219ZM11 6.625C10.3813 6.625 9.875 7.13125 9.875 7.75C9.875 8.36875 10.3813 8.875 11 8.875C11.6187 8.875 12.125 8.36875 12.125 7.75C12.125 7.13125 11.6187 6.625 11 6.625Z" fill=""></path>
        </svg>
      </div>

      <div class="mt-4 flex items-end justify-between">
        <div>
          <h4 class="text-title-md font-bold text-black dark:text-white">
            <%= Competition.where('event_initial_date <= ? AND event_final_date >= ?', Date.current, Date.current).count %>
          </h4>
          <span class="text-sm font-medium">Active Competitions</span>
        </div>
      </div>
    </div>

    <div class="rounded-sm border border-stroke bg-white py-6 px-7.5 shadow-default dark:border-strokedark dark:bg-boxdark">
      <div class="flex h-11.5 w-11.5 items-center justify-center rounded-full bg-meta-2 dark:bg-meta-4">
        <svg class="fill-primary dark:fill-white" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 10H19V4C19 3.45 18.55 3 18 3H17V1C17 0.45 16.55 0 16 0C15.45 0 15 0.45 15 1V3H4C3.45 3 3 3.45 3 4V10H1C0.45 10 0 10.45 0 11C0 11.55 0.45 12 1 12H3V19C3 19.55 3.45 20 4 20H18C18.55 20 19 19.55 19 19V12H21C21.55 12 22 11.55 22 11C22 10.45 21.55 10 21 10ZM5 4H16V10H5V4ZM16 18H5V12H16V18Z" fill=""></path>
        </svg>
      </div>

      <div class="mt-4 flex items-end justify-between">
        <div>
          <h4 class="text-title-md font-bold text-black dark:text-white">
            <%= Competition.where('event_final_date < ?', Date.current).count %>
          </h4>
          <span class="text-sm font-medium">Completed Competitions</span>
        </div>
      </div>
    </div>

    <div class="rounded-sm border border-stroke bg-white py-6 px-7.5 shadow-default dark:border-strokedark dark:bg-boxdark">
      <div class="flex h-11.5 w-11.5 items-center justify-center rounded-full bg-meta-2 dark:bg-meta-4">
        <svg class="fill-primary dark:fill-white" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 10H19V4C19 3.45 18.55 3 18 3H17V1C17 0.45 16.55 0 16 0C15.45 0 15 0.45 15 1V3H4C3.45 3 3 3.45 3 4V10H1C0.45 10 0 10.45 0 11C0 11.55 0.45 12 1 12H3V19C3 19.55 3.45 20 4 20H18C18.55 20 19 19.55 19 19V12H21C21.55 12 22 11.55 22 11C22 10.45 21.55 10 21 10ZM5 4H16V10H5V4ZM16 18H5V12H16V18Z" fill=""></path>
        </svg>
      </div>

      <div class="mt-4 flex items-end justify-between">
        <div>
          <h4 class="text-title-md font-bold text-black dark:text-white">
            <%= Competition.where('event_initial_date > ?', Date.current).count %>
          </h4>
          <span class="text-sm font-medium">Upcoming Competitions</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Competitions -->
  <div class="mt-7.5">
    <div class="mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
      <h2 class="text-title-md2 font-bold text-black dark:text-white">
        Recent Competitions
      </h2>
      <%= link_to admin_competitions_path, class: "inline-flex items-center justify-center rounded-md bg-primary py-2 px-10 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-10" do %>
        View All
      <% end %>
    </div>

    <div class="rounded-sm border border-stroke bg-white px-5 pt-6 pb-2.5 shadow-default dark:border-strokedark dark:bg-boxdark sm:px-7.5 xl:pb-1">
      <div class="flex flex-col">
        <div class="grid grid-cols-6 rounded-sm bg-gray-2 dark:bg-meta-4 sm:grid-cols-8">
          <div class="p-2.5 xl:p-5">
            <h5 class="text-sm font-medium uppercase xsm:text-base">Name</h5>
          </div>
          <div class="p-2.5 text-center xl:p-5">
            <h5 class="text-sm font-medium uppercase xsm:text-base">Start Date</h5>
          </div>
          <div class="p-2.5 text-center xl:p-5">
            <h5 class="text-sm font-medium uppercase xsm:text-base">End Date</h5>
          </div>
          <div class="hidden p-2.5 text-center sm:block xl:p-5">
            <h5 class="text-sm font-medium uppercase xsm:text-base">Status</h5>
          </div>
          <div class="p-2.5 text-center xl:p-5">
            <h5 class="text-sm font-medium uppercase xsm:text-base">Actions</h5>
          </div>
        </div>

        <% if @recent_competitions.any? %>
          <% @recent_competitions.each do |competition| %>
            <div class="grid grid-cols-6 border-b border-stroke dark:border-strokedark sm:grid-cols-8">
              <div class="flex items-center gap-3 p-2.5 xl:p-5">
                <div class="flex-shrink-0">
                  <div class="flex h-12.5 w-12.5 items-center justify-center rounded-full bg-meta-2 dark:bg-meta-4">
                    <svg class="fill-current text-meta-1" width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9 0.5625C4.17188 0.5625 0.375 4.35938 0.375 9.1875C0.375 14.0156 4.17188 17.8125 9 17.8125C13.8281 17.8125 17.625 14.0156 17.625 9.1875C17.625 4.35938 13.8281 0.5625 9 0.5625ZM9 16.3125C5.0625 16.3125 1.875 13.125 1.875 9.1875C1.875 5.25 5.0625 2.0625 9 2.0625C12.9375 2.0625 16.125 5.25 16.125 9.1875C16.125 13.125 12.9375 16.3125 9 16.3125Z" fill=""></path>
                      <path d="M12.375 8.4375H9.5625V5.625C9.5625 5.25 9.1875 4.875 8.8125 4.875C8.4375 4.875 8.0625 5.25 8.0625 5.625V8.4375H5.25C4.875 8.4375 4.5 8.8125 4.5 9.1875C4.5 9.5625 4.875 9.9375 5.25 9.9375H8.0625V12.75C8.0625 13.125 8.4375 13.5 8.8125 13.5C9.1875 13.5 9.5625 13.125 9.5625 12.75V9.9375H12.375C12.75 9.9375 13.125 9.5625 13.125 9.1875C13.125 8.8125 12.75 8.4375 12.375 8.4375Z" fill=""></path>
                    </svg>
                  </div>
                </div>
                <p class="hidden text-black dark:text-white sm:block">
                  <%= competition.name %>
                </p>
              </div>

              <div class="flex items-center justify-center p-2.5 xl:p-5">
                <p class="text-black dark:text-white">
                  <%= competition.event_initial_date&.strftime("%b %d, %Y") %>
                </p>
              </div>

              <div class="flex items-center justify-center p-2.5 xl:p-5">
                <p class="text-black dark:text-white">
                  <%= competition.event_final_date&.strftime("%b %d, %Y") %>
                </p>
              </div>

              <div class="hidden items-center justify-center p-2.5 sm:flex xl:p-5">
                <% if competition.event_final_date && competition.event_final_date < Date.current %>
                  <span class="inline-flex rounded-full bg-opacity-10 py-1 px-3 text-sm font-medium bg-danger text-danger">
                    Completed
                  </span>
                <% elsif competition.event_initial_date && competition.event_initial_date <= Date.current %>
                  <span class="inline-flex rounded-full bg-opacity-10 py-1 px-3 text-sm font-medium bg-success text-success">
                    Active
                  </span>
                <% else %>
                  <span class="inline-flex rounded-full bg-opacity-10 py-1 px-3 text-sm font-medium bg-warning text-warning">
                    Upcoming
                  </span>
                <% end %>
              </div>

              <div class="flex items-center justify-center p-2.5 xl:p-5">
                <div class="flex items-center space-x-3.5">
                  <%= link_to admin_competition_path(competition), class: "hover:text-primary" do %>
                    <svg class="fill-current" width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8.99981 14.8219C3.43106 14.8219 0.674805 9.50624 0.562305 9.28124C0.47793 9.11249 0.47793 8.88749 0.562305 8.71874C0.674805 8.49374 3.43106 3.17812 8.99981 3.17812C14.5686 3.17812 17.3248 8.49374 17.4373 8.71874C17.5217 8.88749 17.5217 9.11249 17.4373 9.28124C17.3248 9.50624 14.5686 14.8219 8.99981 14.8219ZM1.85605 9.00000C2.4748 10.4719 4.89356 13.5562 8.99981 13.5562C13.1061 13.5562 15.5248 10.4719 16.1436 9.00000C15.5248 7.52812 13.1061 4.44374 8.99981 4.44374C4.89356 4.44374 2.4748 7.52812 1.85605 9.00000Z" fill=""></path>
                      <path d="M9 11.3906C7.67812 11.3906 6.60938 10.3219 6.60938 9C6.60938 7.67813 7.67812 6.60938 9 6.60938C10.3219 6.60938 11.3906 7.67813 11.3906 9C11.3906 10.3219 10.3219 11.3906 9 11.3906ZM9 7.875C8.38125 7.875 7.875 8.38125 7.875 9C7.875 9.61875 8.38125 10.125 9 10.125C9.61875 10.125 10.125 9.61875 10.125 9C10.125 8.38125 9.61875 7.875 9 7.875Z" fill=""></path>
                    </svg>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="grid grid-cols-6 border-b border-stroke dark:border-strokedark sm:grid-cols-8">
            <div class="col-span-6 sm:col-span-8 flex items-center justify-center p-2.5 xl:p-5">
              <p class="text-black dark:text-white">No competitions found.</p>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
